(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{21:function(e,t,a){e.exports=a(39)},29:function(e,t,a){},38:function(e,t,a){},39:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),l=a(17),s=a.n(l),o=(a(29),a(12)),c=a(1),i=a(20);const u=Object(i.a)("https://twwapajsbjtwzbripqwn.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InR3d2FwYWpzYmp0d3picmlwcXduIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY2MjM4ODAsImV4cCI6MjA2MjE5OTg4MH0.LbK_Yny94-WyYXI5nujtd_NiT0nAJJirC3pOnvbo5t4");function m(e){let{setUser:t}=e;const[a,l]=Object(r.useState)(""),[s,o]=Object(r.useState)(""),[i,m]=Object(r.useState)(""),d=Object(c.q)();return n.a.createElement("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center"},n.a.createElement("div",{className:"bg-white p-8 rounded-xl shadow-lg w-full max-w-sm"},n.a.createElement("h2",{className:"text-2xl font-semibold text-center mb-6"},"Log in to Rossik"),n.a.createElement("form",{onSubmit:async e=>{e.preventDefault(),m("");const{data:r,error:n}=await u.auth.signInWithPassword({email:a,password:s});if(n)return void m(n.message);sessionStorage.setItem("sb_token",r.session.access_token);r.session.user;t(r.user),d("/")},className:"space-y-4"},n.a.createElement("div",null,n.a.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Email"),n.a.createElement("input",{className:"w-full border p-2 rounded focus:outline-none focus:ring focus:border-blue-500",type:"email",value:a,onChange:e=>l(e.target.value),required:!0})),n.a.createElement("div",null,n.a.createElement("label",{className:"block text-sm font-medium text-gray-700"},"Password"),n.a.createElement("input",{className:"w-full border p-2 rounded focus:outline-none focus:ring focus:border-blue-500",type:"password",value:s,onChange:e=>o(e.target.value),required:!0})),i&&n.a.createElement("p",{className:"text-red-500 text-sm text-center"},i),n.a.createElement("button",{type:"submit",className:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 transition"},"Login"))))}a(37);var d=e=>{let{apiKey:t,onSelect:a}=e;const[l,s]=Object(r.useState)(""),[o,c]=Object(r.useState)([]),[i,u]=Object(r.useState)(null),[m,d]=Object(r.useState)(!1),h=Object(r.useRef)(null),p=async e=>{if(!e||!e.address)return;let r=e.position?e.position.lat:null,n=e.position?e.position.lng:null;if(null===r||null===n){const a=await(async e=>{const a=`https://geocode.search.hereapi.com/v1/geocode?q=${encodeURIComponent(e)}&apiKey=${t}`;try{const e=await fetch(a),t=await e.json();if(t.items&&t.items.length>0)return t.items[0].position}catch(r){console.error("Eroare:",r)}return null})(e.address.label);if(!a)return;r=a.lat,n=a.lng}u(e.address.label),s(""),c([]),h.current&&h.current.blur(),a({lat:r,lng:n,label:e.address.label})};return n.a.createElement("div",{style:{position:"relative"}},n.a.createElement("input",{type:"text",ref:h,value:l,onKeyDown:async e=>{if("Enter"===e.key&&(e.preventDefault(),t&&!(l.length<3))){d(!0);try{const e="https://autocomplete.search.hereapi.com/v1/autocomplete"+`?q=${encodeURIComponent(l)}&apiKey=${t}`,r=await fetch(e),n=await r.json();c(n.items||[])}catch(a){console.error(a)}finally{d(!1)}}},onFocus:()=>{i&&u(null)},onChange:e=>{s(e.target.value)},placeholder:"Enter address or postal code"}),m?n.a.createElement("div",{style:{position:"absolute",top:"100%",left:0}},"Loading..."):null,o.length>0&&!i?n.a.createElement("ul",{style:{position:"absolute",top:"100%",left:0,background:"white",listStyle:"none",padding:"5px",margin:0,border:"1px solid #ccc",width:"100%",zIndex:999}},o.map((e,t)=>{var a;return n.a.createElement("li",{key:t,onClick:()=>p(e),style:{cursor:"pointer",padding:"5px 0"}},(null===(a=e.address)||void 0===a?void 0:a.label)||e.title)})):null)};let h=null;const p=async()=>{if(h)return h;try{const t=await fetch("/rovinieta-prices.json");return h=await t.json()}catch(e){return console.error("Error fetching rovinieta prices:",e),null}},g={ROU:async(e,t,a)=>{var r;const n=await p(),l=n&&n.ROU&&n.ROU[a]||(null===n||void 0===n?void 0:null===(r=n.ROU)||void 0===r?void 0:r[5]);return l?{cost:l[1]}:(console.warn("No pricing data for vehicle with",a,"axles, using default for ROU."),{cost:11})},NLD:async(e,t,a)=>{var r;const n=await p(),l=n&&n.NLD&&n.NLD[a]||(null===n||void 0===n?void 0:null===(r=n.NLD)||void 0===r?void 0:r[5]);return l?{cost:l[1]}:(console.warn("No pricing data for vehicle with",a,"axles, using default for NLD."),{cost:12})},LUX:async(e,t,a)=>{var r;const n=await p(),l=n&&n.LUX&&n.LUX[a]||(null===n||void 0===n?void 0:null===(r=n.LUX)||void 0===r?void 0:r[5]);return l?{cost:l[1]}:(console.warn("No pricing data for vehicle with",a,"axles, using default for LUX."),{cost:12})},DEU:async e=>{return{cost:await f(e.price.value,e.price.currency)}},HUN:async e=>{return{cost:await f(e.price.value,e.price.currency)}},AUT:async e=>{return{cost:await f(e.price.value,e.price.currency)}},FRA:async e=>{return{cost:await f(e.price.value,e.price.currency)}},ITA:async e=>{return{cost:await f(e.price.value,e.price.currency)}},SVN:async e=>{return{cost:await f(e.price.value,e.price.currency)}},SVK:async e=>{return{cost:await f(e.price.value,e.price.currency)}},PRT:async e=>{return{cost:await f(e.price.value,e.price.currency)}},ESP:async e=>{return{cost:await f(e.price.value,e.price.currency)}},BEL:async e=>{return{cost:await f(e.price.value,e.price.currency)}},POL:async e=>{return{cost:await f(e.price.value,e.price.currency)}},CZE:async e=>{return{cost:await f(e.price.value,e.price.currency)}},CHE:async e=>{return{cost:await f(e.price.value,e.price.currency)}}},f=async(e,t)=>{if("number"!==typeof e)return console.warn("Invalid amount for conversion:",e),0;const a=await(async()=>{const e=await fetch("https://api.exchangerate-api.com/v4/latest/EUR");return(await e.json()).rates||{}})();return a[t]?"EUR"===t?e:e/a[t]:(console.error(`Exchange rate for ${t} is not available.`),e)};var b=e=>{let{startCoordinates:t,endCoordinates:a,intermediatePoints:n=[],vehicleType:l,rawDuration:s,rawDistance:o,onTollUpdate:c,selectedRoute:i}=e;const[u,m]=Object(r.useState)({totalCost:0,tollList:[]}),d=Object(r.useRef)(new Set),h=async e=>{try{const a=s&&s>0?s:1,r=["LUX","ROU","NLD"],n={};e.sections&&e.sections.forEach(e=>{e.tollSystems&&e.tollSystems.length>0&&e.summary&&e.tollSystems.forEach(t=>{const a=t.countryCode;r.includes(a)&&(n[a]=Math.max(n[a]||0,e.summary.duration))})});const l={};r.forEach(e=>{l[e]=1});let o=[];o=e.sections&&e.sections.some(e=>e.tolls&&e.tolls.length>0)?await p(e):[];let i=0;const u=new Set;o.forEach(e=>{r.includes(e.country)?u.has(e.country)||(i+=e.cost,u.add(e.country)):i+=e.cost});const d=Math.floor(a/3600),h=Math.floor(a%3600/60),g={totalCost:i,tollList:o,duration:`${d}h ${h}m`};m(g),c(g)}catch(t){console.error("Error processing toll data:",t)}},p=async e=>{let t={};if(!e.sections)return[];for(const n of e.sections)if(n.tolls&&n.tolls.length>0)for(const e of n.tolls){const o=e.countryCode;if(e.fares&&0!==e.fares.length||!o||!g[o]){if(e.fares&&e.fares.length>0)for(const r of e.fares)if(o&&g[o]){var a;const c=["DEU","HUN","AUT","FRA","ITA","SVN","PRT","ESP","BEL","POL","CZE","SVK","CHE"].includes(o)?(null===(a=n.summary)||void 0===a?void 0:a.length)||0:s,i=await g[o](r,c,l.axles),u=`${o}-${r.name||"Default"}`;if(t[u]){if(["ROU","NLD","LUX"].includes(o))continue;t[u].cost+=i.cost}else t[u]={name:r.name||(e.tollSystem?e.tollSystem:`${o}`),country:o,cost:i.cost,currency:"EUR",tollCollectionLocations:e.tollCollectionLocations||[]}}else if(r.price&&r.price.value){const a=e.tollCollectionLocations&&e.tollCollectionLocations.length>0?e.tollCollectionLocations.map(e=>e.name).join("_"):"",n=`${e.countryCode||"Unknown"}-${r.name||"Default"}-${a}`,l=await f(r.price.value,r.price.currency||"EUR");t[n]?t[n].cost=Math.min(t[n].cost,l):t[n]={name:r.name||(e.tollSystem?e.tollSystem:`${e.countryCode||"Unknown"}`),country:e.countryCode||"Unknown",cost:l,currency:"EUR",tollCollectionLocations:e.tollCollectionLocations||[]}}}else{var r;const a={name:e.tollSystem?e.tollSystem:`${o}`,price:{value:0,currency:"EUR"}},s=(null===(r=n.summary)||void 0===r?void 0:r.length)||0,c=await g[o](a,s,l.axles);t[`${o}-Default`]={name:e.tollSystem?e.tollSystem:`${o}`,country:o,cost:c.cost,currency:"EUR",tollCollectionLocations:e.tollCollectionLocations||[]}}}return Object.values(t)};return Object(r.useEffect)(()=>{if(i&&i.id){if(d.current.has(i.id))return;d.current.add(i.id),h(i)}else t&&a&&s&&o&&(async()=>{try{let r=`https://router.hereapi.com/v8/routes?origin=${t.lat},${t.lng}`;n.forEach(e=>{r+=`&via=${e.lat},${e.lng}`}),r+=`&destination=${a.lat},${a.lng}`,r+="&return=polyline,summary,actions,instructions,tolls",r+="&transportMode=truck",r+="&vehicle[height]=400",r+="&vehicle[width]=255",r+="&vehicle[length]=1600",r+=`&truck[axleCount]=${l.axles}`,r+=`&vehicle[grossWeight]=${l.weight}`,r+="&truck[limitedWeight]=7500",r+="&tolls[emissionType]=euro6",r+="&apikey=NtdXMcSjbr4h__U2wEhaC7i-4wTlX71ofanOwpm5E3s";const s=await fetch(r),o=await s.json();if(!o.routes||0===o.routes.length)return void console.error("No routes found");h(o.routes[0])}catch(e){console.error("Error fetching toll data:",e)}})()},[t,a,n,l,s,o,null===i||void 0===i?void 0:i.id]),null};a(38);var y=e=>{let{user:t}=e;const[a,l]=Object(r.useState)("input"),[s,o]=Object(r.useState)([]),[c,i]=Object(r.useState)(null),[u,m]=Object(r.useState)([]),[h,p]=Object(r.useState)(null),[g,f]=Object(r.useState)({axles:5,weight:4e4,EuroPerKm:.1}),[y,E]=Object(r.useState)([]),[v,w]=Object(r.useState)([]),[x,N]=Object(r.useState)(null),[j,C]=Object(r.useState)(null),[O,S]=Object(r.useState)(null),[k,P]=Object(r.useState)(!1),L=Object(r.useRef)(null),$=Object(r.useRef)(null),M=Object(r.useRef)(null);let R=0;const[U,T]=Object(r.useState)(""),[I,D]=Object(r.useState)(""),[H,X]=Object(r.useState)(""),K=localStorage.getItem("token"),F=e=>{let t=0,a=0;e.sections.forEach(e=>{e.summary&&(t+=e.summary.length,a+=e.summary.duration)});const r=t/1e3,n=r*g.EuroPerKm;return{totalDistance:t,totalDuration:a,km:r,costPerKm:n}},A=async()=>{console.log(`getRoute API call #${R}`),P(!0);const e=s[0],t=s[s.length-1],a=s.slice(1,s.length-1);try{let n=`https://router.hereapi.com/v8/routes?origin=${e.lat},${e.lng}`;a.forEach(e=>{e.radius?(e.lat,e.lng,e.radius):(e.lat,e.lng),n+=`&via=${e.lat},${e.lng}`}),n+=`&destination=${t.lat},${t.lng}`,n+="&return=polyline,summary,actions,instructions,tolls",n+="&alternatives=3",n+="&vehicle[weightPerAxle]=11500",n+="&transportMode=truck",n+="&vehicle[height]=400",n+="&vehicle[width]=255",n+="&vehicle[length]=1875",n+=`&truck[axleCount]=${g.axles}`,n+=`&vehicle[grossWeight]=${g.weight}`,n+="&truck[limitedWeight]=7500",n+="&tolls[emissionType]=euro6",n+="&apikey=NtdXMcSjbr4h__U2wEhaC7i-4wTlX71ofanOwpm5E3s";const s=await fetch(n),o=await s.json();if(console.log("Raspuns API: ",o),!o.routes||0===o.routes.length)return console.error("No routes found:",o),alert("No routes found for the selected addresses. Try other locations."),void P(!1);m(o.routes);const c=Array.from({length:o.routes.length},()=>0);E(c);const u=Array.from({length:o.routes.length},()=>({totalCost:0,tollList:[]}));if(w(u),p(0),_(o.routes[0]),o.routes[0].sections&&o.routes[0].sections.length>0){let e=0,t=0;o.routes[0].sections.forEach(a=>{a.summary&&(e+=a.summary.length,t+=a.summary.duration)}),i((e/1e3).toFixed(2)),C(e),S(t);const a=Math.floor(t/3600),r=Math.floor(t%3600/60);N(`${a}h ${r}m`)}l("results"),P(!1)}catch(r){console.error("Error fetching route:",r),alert("An error occurred while calculating the route. Please try again."),P(!1)}},_=e=>{L.current&&(L.current.getObjects().forEach(e=>{e instanceof window.H.map.Polyline&&L.current.removeObject(e)}),e.sections.forEach(e=>{const t=window.H.geo.LineString.fromFlexiblePolyline(e.polyline),a=new window.H.map.Polyline(t,{style:{strokeColor:"blue",lineWidth:4}});L.current.addObject(a);const r=a.getBoundingBox();r&&L.current.getViewModel().setLookAtData({bounds:r})}))};function z(e,t,a){let{lat:r,lng:n}=e;const l=t/6371,s=a,o=r*Math.PI/180,c=n*Math.PI/180,i=Math.asin(Math.sin(o)*Math.cos(l)+Math.cos(o)*Math.sin(l)*Math.cos(s)),u=c+Math.atan2(Math.sin(s)*Math.sin(l)*Math.cos(o),Math.cos(l)-Math.sin(o)*Math.sin(i));return{lat:180*i/Math.PI,lng:180*u/Math.PI}}Object(r.useEffect)(()=>{if(!L.current)return;const e=L.current,t=async t=>{t.preventDefault();const a=t.currentPointer||t.pointer||t,r=e.screenToGeo(a.viewportX,a.viewportY);console.log("Centru cerc:",r),$.current&&e.getObjects().includes($.current)&&e.removeObject($.current),$.current=null;const n=new window.H.map.Circle(r,1e4,{style:{fillColor:"rgba(0,0,255,0.3)",strokeColor:"blue"}});e.addObject(n),$.current=n;const l=await(async(e,t)=>{if(!s.length)return null;const a=s[0],r=s[s.length-1];let n=null,l=1/0;for(let s=0;s<12;s++){const u=z(e,t,2*Math.PI/12*s),m=new URL("https://router.hereapi.com/v8/routes");m.searchParams.set("origin",`${a.lat},${a.lng}`),m.searchParams.set("via",`${u.lat},${u.lng}`),m.searchParams.set("destination",`${r.lat},${r.lng}`),m.searchParams.set("transportMode","truck"),m.searchParams.set("return","summary"),m.searchParams.set("routingMode","fast"),m.searchParams.set("vehicle[height]","400"),m.searchParams.set("vehicle[weightPerAxle]","11500"),m.searchParams.set("vehicle[width]","255"),m.searchParams.set("truck[axleCount]",`${g.axles}`),m.searchParams.set("vehicle[grossWeight]",`${g.weight}`),m.searchParams.set("vehicle[length]","1875"),m.searchParams.set("apikey","NtdXMcSjbr4h__U2wEhaC7i-4wTlX71ofanOwpm5E3s");try{var o,c;const e=await fetch(m),t=await e.json();if(null===(o=t.routes)||void 0===o?void 0:null===(c=o[0])||void 0===c?void 0:c.sections){const e=t.routes[0].sections.reduce((e,t)=>{var a;return e+((null===(a=t.summary)||void 0===a?void 0:a.length)||0)},0);e<l&&(l=e,n={via:u,cost:e})}}catch(i){console.warn("HERE request failed for candidate",u,i)}}return n})(r,10);if(l){const e={lat:l.via.lat,lng:l.via.lng,label:`Lat: ${l.via.lat.toFixed(4)}, Lng: ${l.via.lng.toFixed(4)}`,isVia:!0,radius:1e4},t=await(async(e,t)=>{const a="https://revgeocode.search.hereapi.com/v1/revgeocode"+`?at=${e},${t}`+"&lang=en-US&limit=1&apikey=NtdXMcSjbr4h__U2wEhaC7i-4wTlX71ofanOwpm5E3s";try{const e=await fetch(a),t=await e.json();if(t.items&&t.items.length>0){const e=t.items[0];return{lat:e.position.lat,lng:e.position.lng,label:e.address.label||e.title||"Via Station",isVia:!0,radius:1e4}}}catch(r){console.error("Reverse geocode error:",r)}return null})(l.via.lat,l.via.lng);null===t||void 0===t||t.label,o(t=>[t[0],e,t[t.length-1]]),R++,await A()}else alert("Nu am g\u0103sit niciun drum \xeen zona selectat\u0103.");setTimeout(()=>{$.current&&e.getObjects().includes($.current)&&(e.removeObject($.current),$.current=null)},2e3)};return e.addEventListener("contextmenu",t),()=>e.removeEventListener("contextmenu",t)},[s,u,h]),Object(r.useEffect)(()=>{if(L.current)return;const e=new window.H.service.Platform({apikey:"NtdXMcSjbr4h__U2wEhaC7i-4wTlX71ofanOwpm5E3s"}).createDefaultLayers(),t=new window.H.Map(document.getElementById("mapContainer"),e.vector.normal.map,{zoom:6,center:{lat:44.4268,lng:26.1025}});return new window.H.mapevents.Behavior(new window.H.mapevents.MapEvents(t)),window.H.ui.UI.createDefault(t,e).getControl("mapsettings"),L.current=t,setTimeout(()=>{t.getViewPort().resize()},0),window.addEventListener("resize",()=>t.getViewPort().resize()),()=>{window.removeEventListener("resize",()=>t.getViewPort().resize())}},[v,h]);const V=()=>{if(null===h||0===u.length)return 0;const{costPerKm:e}=F(u[h]);return e};return Object(r.useEffect)(()=>{if(!L.current)return;const e=L.current,t=()=>{const t=e.getZoom();M.current&&M.current.getObjects().forEach(e=>{const a=e.__domElement;if(a){const e=.5+.1*t;a.style.transform=`translate(-50%,-110%) scale(${e})`}})};return e.addEventListener("mapviewchange",t),()=>{e.removeEventListener("mapviewchange",t)}},[]),Object(r.useEffect)(()=>{if(!L.current)return;if(0===s.length)return;M.current&&L.current.removeObject(M.current);const e=new window.H.map.Group;s.forEach((t,a)=>{const r=document.createElement("div");r.className="numbered-marker",r.style.transform="translate(-50%,-110%)";let n="blue";0===a?n="green":a===s.length-1&&(n="red"),r.innerHTML=`<svg viewBox="0 0 24 24" class="arrow-icon">\n        <path d="M12 2 L15 8 H9 L12 2 Z" fill="${0===a?"green":a===s.length-1?"red":"blue"}" />\n      </svg>\n      <span class="marker-label">${a+1}</span>\n      `,document.body.appendChild(r);const{offsetWidth:l,offsetHeight:o}=r;document.body.removeChild(r),r.style.marginLeft=`-${l/2}px`,r.style.marginTop="0px",console.log("el: ",r),console.log("offW: ",l),console.log("offH: ",o);const c=new window.H.map.DomIcon(r),i=new window.H.map.DomMarker({lat:t.lat,lng:t.lng},{icon:c,volatility:!0});i.__domElement=r,e.addObject(i)}),L.current.addObject(e),M.current=e},[s,L.current]),n.a.createElement("div",{className:"App flex flex-col h-screen"},n.a.createElement("header",{className:"bg-white shadow-sm p-4 flex items-center justify-between"},n.a.createElement("div",{className:"flex items-center gap-2"},n.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},n.a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 2l.01 6L7 8c0 1.333 4 2 4 2s4-.667 4-2l-2-.01V2H9zM3 13h7v7H5.5a2.5 2.5 0 01-2.5-2.5V13zM21 13h-7v7h4.5a2.5 2.5 0 002.5-2.5V13z"})),n.a.createElement("h1",{className:"text-xl font-bold text-gray-800"},"Rossik Route Calculation"))),n.a.createElement("div",{className:"flex flex-row flex-1 overflow-hidden"},n.a.createElement("div",{className:"w-1/2 p-4 overflow-auto space-y-4"},n.a.createElement("div",{className:"flex space-x-4"},n.a.createElement("div",{className:"w-1/2 bg-white p-4 rounded shadow-sm"},n.a.createElement("h2",{className:"text-lg font-semibold mb-2"},"Address"),n.a.createElement("form",{onSubmit:async e=>{e.preventDefault(),s.length<2?alert("Trebuie s\u0103 adaugi minimum dou\u0103 adrese \xeenainte de calcul."):(R++,await A())},className:"flex flex-col gap-3"},n.a.createElement("div",null,n.a.createElement("label",{className:"block mb-1 font-medium text-sm text-gray-700"},"Enter the address:"),n.a.createElement(d,{apiKey:"NtdXMcSjbr4h__U2wEhaC7i-4wTlX71ofanOwpm5E3s",onSelect:e=>{o(t=>[...t,e])}})),0===s.length&&n.a.createElement("p",{className:"text-sm text-gray-500"},"No address entered."),n.a.createElement("ul",{className:"border rounded p-2 max-h-40 overflow-y-auto space-y-1"},s.map((e,t)=>n.a.createElement("li",{key:t,className:"flex justify-between items-center"},n.a.createElement("div",{className:"text-sm text-gray-800"},e.isVia?n.a.createElement("em",null,e.label):e.label||`Lat: ${e.lat}, Lng: ${e.lng}`),n.a.createElement("div",{className:"flex gap-2"},n.a.createElement("button",{type:"button",onClick:()=>(e=>{if(0===e)return;const t=[...s];[t[e-1],t[e]]=[t[e],t[e-1]],o(t)})(t),className:"text-xs text-blue-600 hover:underline"},"Up"),n.a.createElement("button",{type:"button",onClick:()=>(e=>{if(e===s.length-1)return;const t=[...s];[t[e],t[e+1]]=[t[e+1],t[e]],o(t)})(t),className:"text-xs text-blue-600 hover:underline"},"Down"),n.a.createElement("button",{type:"button",onClick:()=>(e=>{const t=[...s];t.splice(e,1),o(t)})(t),className:"text-xs text-red-600 hover:underline"},"X"))))),n.a.createElement("button",{type:"submit",disabled:k,className:`mt-3 ${k?"bg-gray-400":"bg-blue-600 hover:bg-blue-700"} text-white py-2 px-4 rounded font-semibold text-sm transition-colors`},k?"Calculare...":"Calculate route"))),n.a.createElement("div",{className:"w-1/2 bg-white p-4 rounded shadow-sm"},n.a.createElement("h2",{className:"text-lg font-semibold mb-2"},"Vehicle Parameters"),n.a.createElement("div",{className:"grid grid-cols-1 gap-2"},n.a.createElement("div",null,n.a.createElement("label",{className:"block text-sm font-medium mb-1"},"Number of axles"),n.a.createElement("input",{type:"number",name:"axles",value:g.axles,onChange:e=>{const t=parseFloat(e.target.value);f(e=>({...e,axles:isNaN(t)?e.axles:t}))},min:"2",max:"10",className:"border rounded w-full p-1 text-sm"})),n.a.createElement("div",null,n.a.createElement("label",{className:"block text-sm font-medium mb-1"},"Tonnage (kg)"),n.a.createElement("input",{type:"number",name:"weight",value:g.weight,onChange:e=>{const t=parseFloat(e.target.value);f(e=>({...e,weight:isNaN(t)?e.weight:t}))},min:"1000",max:"60000",className:"border rounded w-full p-1 text-sm"})),n.a.createElement("div",null,n.a.createElement("label",{className:"block text-sm font-medium mb-1"},"Euro/km"),n.a.createElement("input",{type:"number",inputMode:"decimal",step:"0.01",name:"EuroPerKm",value:g.EuroPerKm,onChange:e=>{const t=e.target.value.trim().replace(",","."),a=parseFloat(t);f(e=>({...e,EuroPerKm:isNaN(a)?e.EuroPerKm:a}))},min:"0",max:"10",className:"border rounded w-full p-1 text-sm"}))))),u.length>0&&n.a.createElement("div",{className:"w-full bg-white p-4 rounded shadow-sm"},n.a.createElement("h2",{className:"text-md font-semibold mb-2"},"Alternative Routes"),n.a.createElement("table",{className:"min-w-full text-sm border border-gray-200"},n.a.createElement("thead",null,n.a.createElement("tr",{className:"bg-gray-50"},n.a.createElement("th",{className:"px-3 py-2 border"},"Route"),n.a.createElement("th",{className:"px-3 py-2 border"},"Distance (km)"),n.a.createElement("th",{className:"px-3 py-2 border"},"Time"),n.a.createElement("th",{className:"px-3 py-2 border"},"Price per Km (EUR)"),n.a.createElement("th",{className:"px-3 py-2 border"},"Tolls (EUR)"),n.a.createElement("th",{className:"px-3 py-2 border"},"Total Cost (EUR)"))),n.a.createElement("tbody",null,u.map((e,t)=>{let a=0,r=0;e.sections.forEach(e=>{e.summary&&(a+=e.summary.length,r+=e.summary.duration)});const l=a/1e3,{costPerKm:s}=F(e),o=`${Math.floor(r/3600)}h ${Math.floor(r%3600/60)}m`,c=y[t]||0,m=s+c;return n.a.createElement("tr",{key:t,className:`cursor-pointer ${h===t?"bg-blue-50":""} hover:bg-gray-50`,onClick:()=>(e=>{if(p(e),_(u[e]),u[e].sections&&u[e].sections.length>0){let t=0,a=0;u[e].sections.forEach(e=>{e.summary&&(t+=e.summary.length,a+=e.summary.duration)}),i((t/1e3).toFixed(2)),C(t),S(a);const r=Math.floor(a/3600),n=Math.floor(a%3600/60);N(`${r}h ${n}m`)}})(t)},n.a.createElement("td",{className:"px-3 py-2 border text-center"},"Route ",t+1),n.a.createElement("td",{className:"px-3 py-2 border text-center"},l.toFixed(2)),n.a.createElement("td",{className:"px-3 py-2 border text-center"},o),n.a.createElement("td",{className:"px-3 py-2 border text-center"},s.toFixed(2)),n.a.createElement("td",{className:"px-3 py-2 border text-center"},c.toFixed(2)),n.a.createElement("td",{className:"px-3 py-2 border text-center"},m.toFixed(2)))})))),u.length>0&&n.a.createElement("div",{className:"flex space-x-4"},n.a.createElement("div",{className:"w-1/2 bg-white p-4 rounded shadow-sm"},n.a.createElement("h3",{className:"text-md font-semibold mb-2"},"List of aggregated costs"),v[h]&&v[h].tollList&&v[h].tollList.length>0?n.a.createElement("ul",{className:"space-y-1 text-sm text-gray-700 max-h-40 overflow-y-auto"},v[h].tollList.map((e,t)=>n.a.createElement("li",{key:t,className:`px-2 py-1 ${t%2===0?"bg-white":"bg-gray-100"}`},e.name," - ",e.country,": ",e.cost.toFixed(2)," ",e.currency||"EUR"))):n.a.createElement("p",{className:"text-gray-500"},"Loading toll costs...")),n.a.createElement("div",{className:"w-1/2 bg-white p-4 rounded shadow-sm"},n.a.createElement("h3",{className:"text-md font-semibold mb-2"},"Route Results"),c?n.a.createElement(n.a.Fragment,null,n.a.createElement("p",{className:"text-sm text-gray-700"},n.a.createElement("strong",null,"Distance:")," ",c," km"),n.a.createElement("p",{className:"text-sm text-gray-700"},n.a.createElement("strong",null,"Travel time:")," ",x),n.a.createElement("p",{className:"text-sm text-gray-700"},n.a.createElement("strong",null,"Price per Km:")," ",c&&g.EuroPerKm?(c*g.EuroPerKm).toFixed(2):"0.00"," EUR"),n.a.createElement("p",{className:"text-sm text-gray-700"},n.a.createElement("strong",null,"Tolls:")," ",y[h]?y[h].toFixed(2):"0.00"," EUR"),n.a.createElement("p",{className:"text-sm text-gray-700 font-semibold"},n.a.createElement("strong",null,"Total Cost:")," ",c&&g.EuroPerKm?(V()+(y[h]||0)).toFixed(2):y[h]?y[h].toFixed(2):"0.00"," EUR")):n.a.createElement("p",{className:"text-gray-500"},"There are no results available."))),u.length>0&&n.a.createElement("div",{className:"mt-4 p-4 border rounded bg-gray-50"},n.a.createElement("h3",{className:"font-semibold mb-2"},"Save this route"),n.a.createElement("div",{className:"flex flex-row gap-4 items-end mb-4"},n.a.createElement("div",{className:"flex-1"},n.a.createElement("label",{className:"block text-sm"},"Truck Plate"),n.a.createElement("input",{className:"border p-1 w-full",placeholder:"e.g. TM 00 RTS",value:U,onChange:e=>T(e.target.value)})),n.a.createElement("div",{className:"flex-1"},n.a.createElement("label",{className:"block text-sm"},"Tour Number"),n.a.createElement("input",{className:"border p-1 w-full",placeholder:"unique ID",value:I,onChange:e=>D(e.target.value)})),n.a.createElement("div",null,n.a.createElement("button",{onClick:async()=>{if(s.length<2)return void alert("Need at least start and end addresses");if(!U)return void alert("Select a truck plate");if(!I)return void alert("Enter a unique run identifier");const e={date:(new Date).toISOString(),identifier:I,addresses:s,euroPerKm:g.EuroPerKm,distance:c,costPerKm:V(),tolls:v[h].tollList,tollCost:v[h].totalCost,totalCost:V()+v[h].totalCost,duration:x};try{const a=await fetch("http://localhost:4000/api/trucks",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${K}`},body:JSON.stringify({plate:U,routeData:e})});if(!a.ok)throw new Error((await a.json()).message||a.statusText);await a.json(),X("Route saved \u2714\ufe0f")}catch(t){X("Save failed: "+t.message)}},className:"bg-green-600 text-white px-4 py-2"},"Save Route"))),H&&n.a.createElement("p",{className:"mt-2 text-sm"},H))),n.a.createElement("div",{className:"w-1/2 h-full",id:"mapContainer"})),n.a.createElement("footer",{className:"bg-white border-t border-gray-200 p-4 text-center text-sm text-gray-500"},"\xa9 2025 Route Truck Wizard - Planificare rute \u0219i calcul taxe rutiere pentru camioane"),n.a.createElement("div",{style:{display:"none"}},u.map((e,t)=>n.a.createElement(b,{key:t,startCoordinates:s.length>=2?s[0]:null,endCoordinates:s.length>=2?s[s.length-1]:null,intermediatePoints:s.length>2?s.slice(1,s.length-1):[],vehicleType:g,rawDuration:O,rawDistance:j,selectedRoute:e,onTollUpdate:e=>((e,t)=>{E(a=>{const r=[...a];return r[e]=t.totalCost||0,r}),w(a=>{const r=[...a];return r[e]=t,r})})(t,e)}))))};function E(e){let{user:t}=e;return n.a.createElement("div",{className:"p-4"},n.a.createElement("h2",{className:"text-xl font-bold mb-4"},"History Page"),n.a.createElement("p",null,"Welcome, ",(null===t||void 0===t?void 0:t.username)||"guest",". Here you'll see your saved routes history."))}var v=function(){const[e,t]=Object(r.useState)(null),[a,l]=Object(r.useState)(!0);return Object(r.useEffect)(()=>{const e=sessionStorage.getItem("sb_token");e&&u.auth.setAuth(e)},[]),Object(r.useEffect)(()=>{u.auth.getUser().then(e=>{let{data:{user:a}}=e;t(a)});const{data:e}=u.auth.onAuthStateChange((e,a)=>{var r;t(null!==(r=null===a||void 0===a?void 0:a.user)&&void 0!==r?r:null)});return()=>{e.subscription.unsubscribe()}},[]),n.a.createElement(o.a,null,n.a.createElement(c.d,null,n.a.createElement(c.b,{path:"/login",element:e?n.a.createElement(c.a,{to:"/"}):n.a.createElement(m,null)}),n.a.createElement(c.b,{path:"/",element:e?n.a.createElement(y,null):n.a.createElement(c.a,{to:"/login"})}),n.a.createElement(c.b,{path:"/history",element:e?n.a.createElement(E,null):n.a.createElement(c.a,{to:"/login"})}),n.a.createElement(c.b,{path:"*",element:e?n.a.createElement(c.a,{to:"/",replace:!0}):n.a.createElement(c.a,{to:"/login",replace:!0})})))};s.a.createRoot(document.getElementById("root")).render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(v,null)))}},[[21,1,2]]]);
//# sourceMappingURL=main.e312f1f2.chunk.js.map